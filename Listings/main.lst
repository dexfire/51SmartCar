C51 COMPILER V9.57.0.0   MAIN                                                              06/30/2018 21:44:17 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Software\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "xunji.h"
   2          
   3          /**
   4           *    51循迹小车
   5           *    基本流程：
   6           *      T0 -> 负责对驱动输出进行控制
   7           *         -> 外层循环[T=20*50us=12.8ms]：time 超过 20 溢出为 0 (@output())
   8           *         -> 内层循环[T=50us]：按照当前模式，循环PWM输出
   9           *         -> PWM ：
  10           *            -> 直行：0         ~    left_time     ~    right_time      ~      20(回0) 
  11           *            ->     左右轮开   [直行]   左轮停     [左转]   右轮停     [空档滑行]   左右轮开
  12           *            -> 左转：0         ~    left_time     ~    right_time      ~      20(回0) 
  13           *            ->     左右轮开   [直行]   左轮停     [左转]   右轮停     [空档滑行]   左右轮开
  14           *            -> 右转：0         ~    right_time     ~    left_time      ~      20(回0) 
  15           *            ->   左右轮开   [直行]   右轮停     [右转]   左轮停     [空档滑行]   左右轮开
  16           *      T1 -> 负责进行流程控制
  17           *         -> 循迹 & 探测
  18           *         -> 切换模式： 十字路口 - 大偏转 - 小偏转
  19           *          -> 十字路口：判断转弯方向
  20           *          -> 偏转：切换输出模式
  21           * 
  22           */
  23          
  24          
  25          void main()
  26          {
  27   1        init();
  28   1        while(1){
  29   2          key_control();
  30   2          set_display_now();
  31   2          //get_wheel_steps();
  32   2          //OLED_Display();
  33   2        }
  34   1      }
  35          
  36          /**
  37           *   定时器 0 中断函数
  38           *   1、循环计时
  39           *   2、output() : 根据当前时间（0~255） 进行左右转
  40           *  
  41           * 
  42           */
  43          void T0_time() interrupt 1     //T0定时中断函数
  44          {
  45   1        TR0=0;                      //关闭T0中断
  46   1        time++;
  47   1        output();                  //输出
  48   1        TR0=1;                //开启T0中断
  49   1      }
  50          
  51          /**
  52           *    定时器 1 中断函数
  53           *    1、
  54           * 
C51 COMPILER V9.57.0.0   MAIN                                                              06/30/2018 21:44:17 PAGE 2   

  55           * 
  56           */
  57          
  58          void T1_time() interrupt 3   //T1定时中断函数
  59          {
  60   1        TR1=0; 
  61   1        infrared();
  62   1        //12M，定时1.5ms
  63   1        TH1=((*current_time_config).sensitivity)>>8;
  64   1        TL1=(*current_time_config).sensitivity; 
  65   1        TR1=1;
  66   1      }
  67          
  68          // void T2_time() interrupt 5   //T2定时中断函数
  69          // {
  70          //  TF2 = 0;
  71          //  runtime++;
  72          //  // 防止 runtime 溢出时tune_time始终大于runtime造成 一直无法加速 的情况
  73          //  if(runtime==0)tune_time=0;
  74          // }
  75          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    156    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
